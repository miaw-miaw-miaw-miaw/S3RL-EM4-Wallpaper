const wallpaperSets = [
    {
        name: "Wallpaper 1",
        main: "./Wallpapers/Wallpaper1/Wallpaper1.jpeg",
        variants: [
            { name: "Original", path: "./Wallpapers/Wallpaper1/Wallpaper1.jpeg" },
            { name: "Albums", path: "./Wallpapers/Wallpaper1/Wallpaper1-Alb.jpeg" },
            { name: "Mini", path: "./Wallpapers/Wallpaper1/Wallpaper1-Min.jpeg" },
            { name: "Mini Albums", path: "./Wallpapers/Wallpaper1/Wallpaper1-Min-Alb.jpeg" },
            { name: "Mini Stroke", path: "./Wallpapers/Wallpaper1/Wallpaper1-Min-Stroke.jpeg" },
            { name: "Mini Stroke Albums", path: "./Wallpapers/Wallpaper1/Wallpaper1-Min-Stroke-Alb.jpeg" }
        ]
    },
    {
        name: "Wallpaper 2",
        main: "./Wallpapers/Wallpaper2/Wallpaper2.jpeg",
        variants: [
            { name: "Original", path: "./Wallpapers/Wallpaper2/Wallpaper2.jpeg" },
            { name: "Albums", path: "./Wallpapers/Wallpaper2/Wallpaper2-Alb.jpeg" },
            { name: "Mini", path: "./Wallpapers/Wallpaper2/Wallpaper2-Min.jpeg" },
            { name: "Mini Albums", path: "./Wallpapers/Wallpaper2/Wallpaper2-Min-Alb.jpeg" },
            { name: "Mini Stroke", path: "./Wallpapers/Wallpaper2/Wallpaper2-Min-Stroke.jpeg" },
            { name: "Mini Stroke Albums", path: "./Wallpapers/Wallpaper2/Wallpaper2-Min-Stroke-Alb.jpeg" }
        ]
    },
    {
        name: "Wallpaper 3",
        main: "./Wallpapers/Wallpaper3/Wallpaper3.jpeg",
        variants: [
            { name: "Original", path: "./Wallpapers/Wallpaper3/Wallpaper3.jpeg" },
            { name: "Albums", path: "./Wallpapers/Wallpaper3/Wallpaper3-Alb.jpeg" },
            { name: "Mini", path: "./Wallpapers/Wallpaper3/Wallpaper3-Min.jpeg" },
            { name: "Mini Albums", path: "./Wallpapers/Wallpaper3/Wallpaper3-Min-Alb.jpeg" },
            { name: "Mini Stroke", path: "./Wallpapers/Wallpaper3/Wallpaper3-Min-Stroke.jpeg" },
            { name: "Mini Stroke Albums", path: "./Wallpapers/Wallpaper3/Wallpaper3-Min-Stroke-Alb.jpeg" }
        ]
    },
    {
        name: "Wallpaper 4",
        main: "./Wallpapers/Wallpaper4/Wallpaper4.jpeg",
        variants: [
            { name: "Original", path: "./Wallpapers/Wallpaper4/Wallpaper4.jpeg" },
            { name: "Albums", path: "./Wallpapers/Wallpaper4/Wallpaper4-Alb.jpeg" },
            { name: "Efect", path: "./Wallpapers/Wallpaper4/Wallpaper4-Efect.jpeg" },
            { name: "Albums Efect", path: "./Wallpapers/Wallpaper4/Wallpaper4-Alb-Efect.jpeg" },
            { name: "Mini", path: "./Wallpapers/Wallpaper4/Wallpaper4-Min.jpeg" },
            { name: "Mini Albums", path: "./Wallpapers/Wallpaper4/Wallpaper4-Min-Alb.jpeg" },
            { name: "Mini Stroke", path: "./Wallpapers/Wallpaper4/Wallpaper4-Min-Stroke.jpeg" },
            { name: "Mini Stroke Albums", path: "./Wallpapers/Wallpaper4/Wallpaper4-Min-Stroke-Alb.jpeg" },
            { name: "Mini Efect", path: "./Wallpapers/Wallpaper4/Wallpaper4-Min-Efect.jpeg" },
            { name: "Mini Albums Efect", path: "./Wallpapers/Wallpaper4/Wallpaper4-Min-Alb-Efect.jpeg" },
            { name: "Mini Stroke Efect", path: "./Wallpapers/Wallpaper4/Wallpaper4-Min-Stroke-Efect.jpeg" },
            { name: "Mini Stroke Albums Efect", path: "./Wallpapers/Wallpaper4/Wallpaper4-Min-Stroke-Alb-Efect.jpeg" }
        ]
    },
    {
        name: "Wallpaper 5",
        main: "./Wallpapers/Wallpaper5/Wallpaper5-Dark.jpeg",
        variants: [
            { name: "Dark", path: "./Wallpapers/Wallpaper5/Wallpaper5-Dark.jpeg" },
            { name: "Light", path: "./Wallpapers/Wallpaper5/Wallpaper5-Light.jpeg" },
            { name: "Albums Dark", path: "./Wallpapers/Wallpaper5/Wallpaper5-Alb-Dark.jpeg" },
            { name: "Albums Light", path: "./Wallpapers/Wallpaper5/Wallpaper5-Alb-Light.jpeg" },
            { name: "Mini Dark", path: "./Wallpapers/Wallpaper5/Wallpaper5-Min-Dark.jpeg" },
            { name: "Mini Light", path: "./Wallpapers/Wallpaper5/Wallpaper5-Min-Light.jpeg" },
            { name: "Mini Albums Dark", path: "./Wallpapers/Wallpaper5/Wallpaper5-Min-Alb-Dark.jpeg" },
            { name: "Mini Albums Light", path: "./Wallpapers/Wallpaper5/Wallpaper5-Min-Alb-Light.jpeg" },
            { name: "Mini Stroke Dark", path: "./Wallpapers/Wallpaper5/Wallpaper5-Min-Stroke-Dark.jpeg" },
            { name: "Mini Stroke Light", path: "./Wallpapers/Wallpaper5/Wallpaper5-Min-Stroke-Light.jpeg" },
            { name: "Mini Stroke Albums Dark", path: "./Wallpapers/Wallpaper5/Wallpaper5-Min-Stroke-Alb-Dark.jpeg" },
            { name: "Mini Stroke Albums Light", path: "./Wallpapers/Wallpaper5/Wallpaper5-Min-Stroke-Alb-Light.jpeg" }
        ]
    },
    {
        name: "Wallpaper 6",
        main: "./Wallpapers/Wallpaper6/Wallpaper6.jpeg",
        variants: [
            { name: "Original", path: "./Wallpapers/Wallpaper6/Wallpaper6.jpeg" },
            { name: "Alternative", path: "./Wallpapers/Wallpaper6/Wallpaper6-ALT.jpeg" },
            { name: "Albums", path: "./Wallpapers/Wallpaper6/Wallpaper6-Alb.jpeg" },
            { name: "Albums Alternative", path: "./Wallpapers/Wallpaper6/Wallpaper6-Alb-ALT.jpeg" },
            { name: "Mini", path: "./Wallpapers/Wallpaper6/Wallpaper6-Min.jpeg" },
            { name: "Mini Alternative", path: "./Wallpapers/Wallpaper6/Wallpaper6-Min-ALT.jpeg" },
            { name: "Mini Albums", path: "./Wallpapers/Wallpaper6/Wallpaper6-Min-Alb.jpeg" },
            { name: "Mini Albums Alternative", path: "./Wallpapers/Wallpaper6/Wallpaper6-Min-Alb-ALT.jpeg" },
            { name: "Mini Stroke", path: "./Wallpapers/Wallpaper6/Wallpaper6-Min-Stroke.jpeg" },
            { name: "Mini Stroke Alternative", path: "./Wallpapers/Wallpaper6/Wallpaper6-Min-Stroke-ALT.jpeg" },
            { name: "Mini Stroke Albums", path: "./Wallpapers/Wallpaper6/Wallpaper6-Min-Stroke-Alb.jpeg" },
            { name: "Mini Stroke Albums Alternative", path: "./Wallpapers/Wallpaper6/Wallpaper6-Min-Stroke-Alb-ALT.jpeg" }
        ]
    },
    {
        name: "Wallpaper 7",
        main: "./Wallpapers/Wallpaper7/Wallpaper7.jpeg",
        variants: [
            { name: "Original", path: "./Wallpapers/Wallpaper7/Wallpaper7.jpeg" },
            { name: "Alternative", path: "./Wallpapers/Wallpaper7/Wallpaper7-ALT.jpeg" },
            { name: "Dark", path: "./Wallpapers/Wallpaper7/Wallpaper7-Dark.jpeg" },
            { name: "Dark Alternative", path: "./Wallpapers/Wallpaper7/Wallpaper7-Dark-ALT.jpeg" },
            { name: "Light", path: "./Wallpapers/Wallpaper7/Wallpaper7-Light.jpeg" },
            { name: "Albums", path: "./Wallpapers/Wallpaper7/Wallpaper7-Alb.jpeg" },
            { name: "Albums Alternative", path: "./Wallpapers/Wallpaper7/Wallpaper7-Alb-ALT.jpeg" },
            { name: "Albums Dark", path: "./Wallpapers/Wallpaper7/Wallpaper7-Alb-Dark.jpeg" },
            { name: "Albums Dark Alternative", path: "./Wallpapers/Wallpaper7/Wallpaper7-Alb-Dark-ALT.jpeg" },
            { name: "Albums Light", path: "./Wallpapers/Wallpaper7/Wallpaper7-Alb-Light.jpeg" },
            { name: "Mini", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min.jpeg" },
            { name: "Mini Alternative", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-ALT.jpeg" },
            { name: "Mini Dark", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-Dark.jpeg" },
            { name: "Mini Dark Alternative", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-Dark-ALT.jpeg" },
            { name: "Mini Light", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-Light.jpeg" },
            { name: "Mini Albums", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-Alb.jpeg" },
            { name: "Mini Albums Alternative", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-Alb-ALT.jpeg" },
            { name: "Mini Albums Dark", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-Alb-Dark.jpeg" },
            { name: "Mini Albums Dark Alternative", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-Alb-Dark-ALT.jpeg" },
            { name: "Mini Albums Light", path: "./Wallpapers/Wallpaper7/Wallpaper7-Min-Alb-Light.jpeg" }
        ]
    },
    {
        name: "Wallpaper 8",
        main: "./Wallpapers/Wallpaper8.jpeg",
        variants: [{ name: "Original", path: "./Wallpapers/Wallpaper8.jpeg" }]
    },
    {
        name: "Wallpaper 9",
        main: "./Wallpapers/Wallpaper9/Wallpaper9.jpeg",
        variants: [
            { name: "Original", path: "./Wallpapers/Wallpaper9/Wallpaper9.jpeg" },
            { name: "No S3RL", path: "./Wallpapers/Wallpaper9/Wallpaper9-NoS3RL.jpeg" }
        ]
    },
    {
        name: "Wallpaper 10",
        main: "./Wallpapers/Wallpaper10.jpeg",
        variants: [{ name: "Original", path: "./Wallpapers/Wallpaper10.jpeg" }]
    },
    {
        name: "Wallpaper 11",
        main: "./Wallpapers/Wallpaper11/Wallpaper11.jpeg",
        variants: [
            { name: "Original", path: "./Wallpapers/Wallpaper11/Wallpaper11.jpeg" },
            { name: "Alternative", path: "./Wallpapers/Wallpaper11/Wallpaper11-ALT.jpeg" },
            { name: "Mini", path: "./Wallpapers/Wallpaper11/Wallpaper11-Min.jpeg" },
            { name: "Mini Alternative", path: "./Wallpapers/Wallpaper11/Wallpaper11-Min-ALT.jpeg" }
        ]
    },
    {
        name: "Wallpaper 12",
        main: "./Wallpapers/Wallpaper12.jpeg",
        variants: [{ name: "Original", path: "./Wallpapers/Wallpaper12.jpeg" }]
    },
    {
        name: "Wallpaper 13",
        main: "./Wallpapers/Wallpaper13/Wallpaper13-Dark.jpeg",
        variants: [
            { name: "Dark", path: "./Wallpapers/Wallpaper13/Wallpaper13-Dark.jpeg" },
            { name: "Light", path: "./Wallpapers/Wallpaper13/Wallpaper13-Light.jpeg" },
            { name: "Alternative", path: "./Wallpapers/Wallpaper13/Wallpaper13-ALT.jpeg" },
            { name: "Alternative 2", path: "./Wallpapers/Wallpaper13/Wallpaper13-ALT-2.jpeg" },
            { name: "Alternative 3", path: "./Wallpapers/Wallpaper13/Wallpaper13-ALT-3.jpeg" },
            { name: "Alternative 4", path: "./Wallpapers/Wallpaper13/Wallpaper13-ALT-4.jpeg" },
            { name: "Alternative 5", path: "./Wallpapers/Wallpaper13/Wallpaper13-ALT-5.jpeg" },
            { name: "Alternative 6", path: "./Wallpapers/Wallpaper13/Wallpaper13-ALT-6.jpeg" }
        ]
    },
    {
        name: "Wallpaper 14",
        main: "./Wallpapers/Wallpaper14.jpeg",
        variants: [{ name: "Original", path: "./Wallpapers/Wallpaper14.jpeg" }]
    },
    {
        name: "Wallpaper 15",
        main: "./Wallpapers/Wallpaper15/Wallpaper15-1.jpeg",
        variants: [
            { name: "Version 1", path: "./Wallpapers/Wallpaper15/Wallpaper15-1.jpeg" },
            { name: "Version 2", path: "./Wallpapers/Wallpaper15/Wallpaper15-2.jpeg" },
            { name: "Version 3", path: "./Wallpapers/Wallpaper15/Wallpaper15-3.jpeg" }
        ]
    },
    {
        name: "Wallpaper 16",
        main: "./Wallpapers/Wallpaper16.jpeg",
        variants: [{ name: "Original", path: "./Wallpapers/Wallpaper16.jpeg" }]
    }
];

const list = document.getElementById('wallpaper-list');
const modal = document.getElementById('wallpaper-modal');
const modalImg = document.getElementById('modal-preview');
const downloadBtn = document.getElementById('download-btn');
const variantsList = document.getElementById('variants-list');
const mobileBlocker = document.getElementById('mobile-blocker');

function isPhone() {
    const userAgent = navigator.userAgent || navigator.vendor || window.opera;
    const isSmallWidth = window.innerWidth < 600;
    
    const hasPhoneUA = /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|rim)|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(userAgent.substr(0, 4));
    const hasTabletUA = /(ipad|tablet|playbook|silk)|(android(?!.*mobile))/i.test(userAgent);

    return (hasPhoneUA || isSmallWidth) && !hasTabletUA;
}

function handleMobileBlocking() {
    if (isPhone()) {
        mobileBlocker.style.display = 'flex';
        mobileBlocker.setAttribute('aria-hidden', 'false');
        document.querySelectorAll('body > :not(#mobile-blocker)').forEach(el => {
            el.style.display = 'none';
        });
        document.body.style.overflow = 'hidden';
    }
}

function renderVariantsGrid(set) {
    const container = document.getElementById('variants-list');
    container.innerHTML = '';
    
    const fragment = document.createDocumentFragment();

    set.variants.forEach((variant) => {
        const card = document.createElement('div');
        card.className = 'variant-card';
        card.tabIndex = 0;
        
        if (variant.path === modalImg.getAttribute('src')) {
            card.classList.add('active');
        }

        card.innerHTML = `
            <div class="variant-thumb-wrapper">
                <img src="${variant.path}" alt="${variant.name}" loading="lazy">
            </div>
            <span class="variant-name">${variant.name}</span>
        `;

        const selectThis = () => {
            document.querySelectorAll('.variant-card').forEach(c => c.classList.remove('active'));
            card.classList.add('active');
            updateModalPreview(variant);
        };

        card.onclick = selectThis;
        card.onkeydown = (e) => { if (e.key === 'Enter') selectThis(); };
        
        fragment.appendChild(card);
    });
    
    container.appendChild(fragment);
}

function openModal(set) {
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
    
    updateModalPreview(set.variants[0]);
    
    const variantsContainer = document.querySelector('.variants-container');
    const modalContent = document.querySelector('.modal-content');
    
    if (set.variants.length <= 1) {
        variantsContainer.style.display = 'none';
        modalContent.classList.add('is-single');
    } else {
        variantsContainer.style.display = 'block';
        modalContent.classList.remove('is-single');
        renderVariantsGrid(set);
    }
}

function updateModalPreview(variant) {
    if (!variant) return;
    modalImg.src = variant.path;
    downloadBtn.href = variant.path;
}

function closeModal() {
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
}

window.addEventListener('click', (event) => {
    if (event.target === modal) closeModal();
});

window.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') closeModal();
});

function initGallery() {
    handleMobileBlocking();
    
    const fragment = document.createDocumentFragment();
    
    wallpaperSets.forEach((set) => {
        const item = document.createElement('div');
        item.className = 'wallpaper-item';
        item.tabIndex = 0;
        item.setAttribute('role', 'button');
        item.setAttribute('aria-label', `Ver detalles de ${set.name}`);
        
        const img = document.createElement('img');
        img.src = set.main;
        img.alt = set.name;
        img.loading = 'lazy';
        
        const info = document.createElement('div');
        info.className = 'wallpaper-info';
        const variantsCount = set.variants.length > 1 ? `<p>${set.variants.length} Variants Available</p>` : '';
        info.innerHTML = `<h3>${set.name}</h3>${variantsCount}`;
        
        item.appendChild(img);
        item.appendChild(info);
        
        const clickHandler = () => openModal(set);
        item.addEventListener('click', clickHandler);
        item.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') clickHandler(); });
        
        fragment.appendChild(item);
    });
    
    list.appendChild(fragment);
}

document.addEventListener('DOMContentLoaded', initGallery);